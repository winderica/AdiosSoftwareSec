[
  "    int main()\n    {\n            int a,b,c;\n            char szBuf[8] = {0};\n            a=strcpy(szBuf, \"123456789900\", 123);\n            gets();\n            b=func_B(b);\n            c=a+b;\n            return func_C({1, 2, 3});\n    }\n",
  "#include \"../inc/usbshare_server.h\"\n\nvoid sigchld_handler(int s)\n{\n while(wait(NULL) > 0);\n}\n\nint main()  \n{\n int sockfd, new_fd, ret, i; \n sockfd=sock_setup();\n char temp[MAXDATASIZE];\n struct sigaction sa;\n sa.sa_handler = sigchld_handler;\n sigemptyset(&sa.sa_mask);\n sa.sa_flags = SA_RESTART;\n if(sigact(SIGCHLD, &sa, NULL) == -1)\n {\n  perror(\"Server-sigaction() error\");\n  exit(1);\n }\n while(1)\n {\n  new_fd=accept_con(sockfd);\n  if(!fork())\n  {\n   close(sockfd);\n   \n   /* GET DEV LST */\n\n   char * devlst=getdevlst(); \n   send_msg(new_fd, devlst);\n   send_msg(new_fd, itoa(nodevices, 10));\n   strcpy(rbuf,recv_msg(new_fd));\n   strcpy(dir,devices[atoi(rbuf)-1]);\n   strcpy(device,dir);\n   strcpy(tempdir,dir);\n   send_msg(new_fd, device);\n\n   while(1)\n   {\n    strcpy(rbuf,recv_msg(new_fd));\n\n    /* LIST */\n\n    if(!strcmp(rbuf,\"list\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     strcpy(tempdir,dir);\n     if(strcmp(rbuf,\".\"))\n     {\n      sprintf(dir,\"%s%s\",dir,rbuf);\n     }\n     char * lst=list();\n     send_msg(new_fd, lst);\n     strcpy(dir,tempdir);\n    }\n  \n    /* FREESPACE */\n\n    else if(!strcmp(rbuf,\"freespace\"))\n    {\n     char *usage=freespace();\n     strcpy(sbuf,usage);\n     send_msg(new_fd, sbuf);\n    }\n\n    /* MAKEDIR */\n    \n    else if(!strcmp(rbuf,\"makedir\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *path=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(path,\"%s%s\",dir,rbuf);\n     ret=makedir(path);\n     if(!ret) \n      strcpy(sbuf,\"Directory created successfully!\");\n     else\n      strcpy(sbuf,\"Unsuccessful!\");\n     send_msg(new_fd, sbuf);\n    }\n   \n    /* RMV */\n\n    else if(!strcmp(rbuf,\"rmv\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *dirname=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(dirname,\"%s%s\",dir,rbuf);\n     ret=rmv(dirname, new_fd);\n     if(!ret) \n      strcpy(sbuf,\"File/Directory removed successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n    }\n \n    /* CHDIR */\n\n    else if(!strcmp(rbuf,\"chdir\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     int ret=chgdir(rbuf);\n     if(ret) \n     {\n      strcpy(sbuf, \"Invalid operation!\"); \n      send_msg(new_fd, sbuf);\n     }\n     else       \n      send_msg(new_fd, dir);\n    }\n\n    /* CP FILE FROM */\n    \n    else if(!strcmp(rbuf,\"cpfilefrom\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *path=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(path,\"%s%s\",dir,rbuf);\n     ret=copyfilefromusb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"File copied successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n    }\n\n    /* MV FILE FROM */\n\n    else if(!strcmp(rbuf,\"mvfilefrom\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *path=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(path,\"%s%s\",dir,rbuf);\n     ret=movefilefromusb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"File moved successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n    }\n\n    /* CP FILE TO */\n   \n    else if(!strcmp(rbuf,\"cpfileto\"))\n    {\n     strcpy(tempdir,dir);\n     strcpy(temp,recv_msg(new_fd));\n     strcpy(rbuf,recv_msg(new_fd));\n     if(strcmp(rbuf,\".\")) sprintf(dir,\"%s%s\",dir,rbuf);\n     ret=copyfiletousb(temp, dir, new_fd);\n     if(!ret) \n      strcpy(sbuf,\"File copied successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n     strcpy(dir, tempdir);\n    }\n    \n    /* MV FILE TO */\n\n    else if(!strcmp(rbuf,\"mvfileto\"))\n    {\n     strcpy(tempdir,dir);\n     strcpy(temp,recv_msg(new_fd));\n     strcpy(rbuf,recv_msg(new_fd));\n     if(strcmp(rbuf,\".\")) sprintf(dir,\"%s%s\",dir,rbuf);\n     ret=movefiletousb(temp, dir, new_fd);\n     if(!ret) \n      strcpy(sbuf,\"File copied successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n     strcpy(dir, tempdir);\n    }\n     \n    /* CP DIR FROM */\n  \n    else if(!strcmp(rbuf,\"cpdirfrom\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *path=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(path,\"%s%s\",dir,rbuf);\n     ret=copydirfromusb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"Directory copied successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n    }   \n \n    /* MV DIR FROM */\n\n    else if(!strcmp(rbuf,\"mvdirfrom\"))\n    {\n     strcpy(rbuf,recv_msg(new_fd));\n     char *path=(char *) malloc(strlen(dir)+strlen(rbuf)+1);\n     sprintf(path,\"%s%s\",dir,rbuf);\n     ret=movedirfromusb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"Directory moved successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n    }\n    \n    /* CP DIR TO */\n\n    else if(!strcmp(rbuf,\"cpdirto\"))\n    {\n     strcpy(tempdir,dir);\n     strcpy(temp,recv_msg(new_fd));\n     strcpy(rbuf,recv_msg(new_fd));\n     if(strcmp(rbuf,\".\")) sprintf(dir,\"%s%s\",dir,rbuf);\n     char *path=(char *) malloc(strlen(dir)+strlen(temp)+1);\n     sprintf(path,\"%s%s\",dir,temp);\n     if(makedir(path)) return 1;\n     ret=copydirtousb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"Directory copied successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n     strcpy(dir, tempdir);\n    }   \n \n    /* MVDIRTO */\n\n    else if(!strcmp(rbuf,\"mvdirto\"))\n    {\n     strcpy(tempdir,dir);\n     strcpy(temp,recv_msg(new_fd));\n     strcpy(rbuf,recv_msg(new_fd));\n     if(strcmp(rbuf,\".\")) sprintf(dir,\"%s%s\",dir,rbuf);\n     char *path=(char *) malloc(strlen(dir)+strlen(temp)+1);\n     sprintf(path,\"%s%s\",dir,temp);\n     if(makedir(path)) return 1;\n     ret=copydirtousb(path,new_fd);\n     if(!ret) \n      strcpy(sbuf,\"Directory moved successfully!\");\n     else\n      strcpy(sbuf,\"Operation aborted!\");\n     send_msg(new_fd, sbuf);\n     strcpy(dir, tempdir);\n    }   \n    \n    /* RENAME */\n\n    else if (!strcmp(rbuf, \"rename\"))\n    { \n     char rbuf1[MAXDATASIZE], rbuf2[MAXDATASIZE];\n     strcpy(rbuf1, recv_msg(new_fd));\n     strcpy(rbuf2, recv_msg(new_fd));\n     ret = renamedir(rbuf1 , rbuf2);      \n     if(!ret) \n      strcpy(sbuf,\"File/Directory renamed successfully!\");\n     else\n      strcpy(sbuf,\"Operation Aborted!\"); \n     send_msg(new_fd, sbuf);\n    }\n    \n    /* QUIT */\n \n    else if(!strcmp(rbuf,\"quit\"))\n    { \n     close(new_fd); \n     exit(0);\n    }\n   } \n   close(new_fd);\n   exit(0);\n  }\n\n  close(new_fd);\n }\n return 0;\n}"
]
