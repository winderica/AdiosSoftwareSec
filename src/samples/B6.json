[
  "#include \"train.h\"\n\n/**********************************************\n* Fonction pour le trajet des TGV est-ouest   *\n**********************************************/\nvoid TGV_EO (Train *t)\n{\n\tprintf(\"\\nLe TGV %i à destination de %s a été signalé venant de l'Est.\\n\", t->id,t->destination);\n\tpthread_mutex_lock (&tunGar);\n\ttunnel->TGV++;\n\tpthread_mutex_unlock (&tunGar);\n\tsem_wait(tunnel->semTGV);\n\tpthread_mutex_lock (&tunGar);\n\ttunnel->occupee++;\n\ttunnel->TGV--;\n\tpthread_mutex_unlock (&tunGar);\n\tprintf(\"Le TGV %i emprunte la voie L.\\n\",t->id );\n\tsleep((int)tunnel->longueur/3);\n\tprintf(\"Le TGV %i emprunte le tunnel.\\n\",t->id);\n\tsleep((int)2*tunnel->longueur/3);\n\tpthread_mutex_lock (&tunGar);\n\tgTGV->occupee++;\n\ttunnel->occupee--;\n\tpthread_mutex_unlock (&tunGar);\n\tprintf(\"Le TGV %i est sur la voie de garage TGV.\\n\",t->id );\n\tpthread_mutex_lock (&voieGL);\n\tvoieD->TGV++;\n\tpthread_mutex_unlock (&voieGL);\n\tsem_wait(voieD->semTGV);\n\tpthread_mutex_lock (&voieGL);\n\tvoieD->reservee++;\n\tvoieD->TGV--;\n\taig2->TGV++;\n\tpthread_mutex_unlock (&voieGL);\n\tsem_wait(aig2->semTGV);\n\tpthread_mutex_lock (&voieGL);\n\taig2->occupee++;\n\taig2->TGV--;\n\tpthread_mutex_unlock (&voieGL);\n\tpthread_mutex_lock (&tunGar);\n\tgTGV->occupee--;\n\tpthread_mutex_unlock (&tunGar);\n\tprintf(\"Le TGV %i emprunte l'aiguillage 2.\\n\",t->id );\n\tsleep(aig2->longueur);\n\tpthread_mutex_lock (&voieGL);\n\tvoieD->occupee++;\n\tvoieD->reservee--;\n\taig2->occupee--;\n\tpthread_mutex_unlock (&voieGL);\n\tprintf(\"Le TGV %i s’arrête voie D.\\n\",t->id);\n\tsleep(voieD->longueur);\n\tpthread_mutex_lock (&voieGL);\n\tvoieD->occupee--;\n\tpthread_mutex_unlock (&voieGL);\n\tprintf(\"Le TGV %i continue sa route vers %s \\n\",t->id, t->destination);\n}\n\n/**********************************************\n* Fonction pour le trajet des TGV ouest-est   *\n**********************************************/\nvoid TGV_OE (Train *t)\n{\n\tprintf(\"\\nLe TGV %i à destination de %s a été signalé venant de l'Ouest.\\n\", t->id,t->destination);\n\tpthread_mutex_lock (&voieGL);\n\tvoieC->TGV++;\n\tpthread_mutex_unlock (&voieGL);\n\t//printf(\"Voie C %i TGV en attente\\n\",voieC->TGV );\n\tsem_wait(voieC->semTGV);\n\tpthread_mutex_lock (&voieGL);\n\tvoieC->TGV--;\n\tvoieC->occupee++;\n\tpthread_mutex_unlock (&voieGL);\n\tprintf(\"Le TGV %i s’arrête voie C.\\n\",t->id);\n\tsleep(voieC->longueur);\n\tpthread_mutex_lock (&voieGL);\n\taig2->TGV++;\n\tpthread_mutex_unlock (&voieGL);\n\tsem_wait(aig2->semTGV);\n\tpthread_mutex_lock (&voieGL);\n\taig2->occupee++;\n\tvoieC->occupee--;\n\taig2->TGV--;\n\tpthread_mutex_unlock (&voieGL);\n\tprintf(\"Le TGV %i emprunte l'aiguillage 2.\\n\",t->id );\n\tsleep(aig2->longueur);\n\tpthread_mutex_lock (&voieGL);\n\taig2->occupee--;\n\tpthread_mutex_unlock (&voieGL);\n\tpthread_mutex_lock (&tunGar);\n\tgTGV->occupee++;\n\tprintf(\"Le TGV %i est sur la voie de garage TGV.\\n\",t->id );\n\ttunnel->TGV++;\n\tpthread_mutex_unlock (&tunGar);\n\tsem_wait(tunnel->semTGV);\n\tpthread_mutex_lock (&tunGar);\n\ttunnel->occupee++;\n\tgTGV->occupee--;\n\ttunnel->TGV--;\n\tpthread_mutex_unlock (&tunGar);\n\tprintf(\"Le TGV %i emprunte le tunnel.\\n\",t->id );\n\tsleep((int)2*tunnel->longueur/3);\n\tprintf(\"Le TGV %i emprunte la voie L.\\n\",t->id );\n\tsleep((int)tunnel->longueur/3);\n\tpthread_mutex_lock (&tunGar);\n\ttunnel->occupee--;\n\tpthread_mutex_unlock (&tunGar);\n\tprintf(\"Le TGV %i continue sa route vers %s \\n\",t->id, t->destination);\n}\n"
]
